{% extends 'backEnd_superAdmin/index.html' %}
{% load static %}


{% block dataTable_css %}
<!-- DataTables -->
<link rel="stylesheet"
      href="{% static 'backEnd/bower_components/datatables.net-bs/css/dataTables.bootstrap.min.css' %}">

<link rel="stylesheet" href="{% static 'backEnd/home.css' %}">
{% endblock %}

{% block main_block %}

<!-- Content Header (Page header) -->
<section class="content-header">
    <h1>
        Dashboard
        <small>Analytics</small>
    </h1>
    <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
        <li class="active">Analytics</li>
    </ol>
</section>

<!-- Main content -->
<section class="content">
    <!-- Info boxes -->
    <div class="row">
        <div class="col-md-3 col-sm-6 col-xs-12">
            <div class="info-box">
                <span class="info-box-icon bg-aqua"><i class="ion ion-ios-gear-outline"></i></span>

                <div class="info-box-content">
                    <span class="info-box-text">Total Spin Points Given</span>
                    <span class="info-box-number">{{total_spin_pointsGiven.total_pointsOf_crnt_user__sum}}</span>
                </div>

                <div class="info-box-content">
                    <a href="/ap/total/spin/point/given/user/list">See Details</a>
                </div>
                <!-- /.info-box-content -->
            </div>
            <!-- /.info-box -->
        </div>
        <!-- /.col -->
        <div class="col-md-3 col-sm-6 col-xs-12">
            <div class="info-box">
                <span class="info-box-icon bg-red"><i class="fa fa-google-plus"></i></span>

                <div class="info-box-content">
                    <span class="info-box-text">Total Spin Credit Given</span>
                    <span class="info-box-number">{% if total_spin_credit_given.total_credts_ofCurrentUser__sum %} {{total_spin_credit_given.total_credts_ofCurrentUser__sum}} {% else %} 0 {% endif %}</span>
                </div>

                <div class="info-box-content">
                    <a href="/ap/total/spin/credit/given/user/list">See Details</a>
                </div>
                <!-- /.info-box-content -->
            </div>
            <!-- /.info-box -->
        </div>
        <!-- /.col -->

        <!-- fix for small devices only -->
        <div class="clearfix visible-sm-block"></div>

        <div class="col-md-3 col-sm-6 col-xs-12">
            <div class="info-box">
                <span class="info-box-icon bg-green"><i class="ion ion-ios-cart-outline"></i></span>

                <div class="info-box-content">
                    <span class="info-box-text">Total Spin Tokens Given</span>
                    <span class="info-box-number">{% if total_spin_tokens_given.total_credts_ofCurrentUser__sum %}{{total_spin_tokens_given.total_credts_ofCurrentUser__sum}} {% else %} 0 {% endif %}</span>
                </div>

                <div class="info-box-content">
                    <a href="/ap/total/spin/tokens/given/user/lists">See Details</a>
                </div>
                <!-- /.info-box-content -->
            </div>
            <!-- /.info-box -->
        </div>
        <!-- /.col -->
        <div class="col-md-3 col-sm-6 col-xs-12">
            <div class="info-box">
                <span class="info-box-icon bg-yellow"><i class="ion ion-ios-people-outline"></i></span>

                <div class="info-box-content">
                    <span class="info-box-text">Total Accounts</span>
                    <span class="info-box-number">{{total_registered_usr}}</span>
                </div>

                <div class="info-box-content">
                    <a href="/ap/registered/user/list">See Details</a>
                </div>
                <!-- /.info-box-content -->
            </div>
            <!-- /.info-box -->
        </div>
        <!-- /.col -->
    </div>
    <!-- /.row -->

    <!-- Small boxes (Stat box) -->
    <div class="row">

        <div class="col-lg-3 col-xs-6">
            <!-- small box -->
            <div class="small-box bg-aqua">
                <div class="inner">
                    <h3>{% if total_no_times_played_game %} {{total_no_times_played_game}} {% else %} 0 {% endif %}</h3>

                    <p>Total No of Times Played</p>
                </div>
                <div class="icon">
                    <i class="ion ion-bag"></i>
                </div>
                <a href="/ap/all/prizes/for/analytics" class="small-box-footer">More info <i
                        class="fa fa-arrow-circle-right"></i></a>
            </div>
        </div>
        <!-- ./col -->
        <div class="col-lg-3 col-xs-6">
            <!-- small box -->
            <div class="small-box bg-yellow">
                <div class="inner">
                    <h3>{{total_no_of_times_prizes_won}}</h3>

                    <p>Total Prize Won</p>
                </div>
                <div class="icon">
                    <i class="ion ion-person-add"></i>
                </div>
                <a href="/ap/all/prizes/for/analytics" class="small-box-footer">More info <i
                        class="fa fa-arrow-circle-right"></i></a>
            </div>
        </div>
        <!-- ./col -->

        <div class="col-lg-3 col-xs-6">
            <!-- small box -->
            <div class="small-box bg-green">
                <div class="inner">
                    <h3>{{total_number_of_products}}<sup style="font-size: 20px"></sup></h3>

                    <p>Product List</p>
                </div>
                <div class="icon">
                    <i class="ion ion-stats-bars"></i>
                </div>
                <a href="/ap/all/product/list" class="small-box-footer">More info <i
                        class="fa fa-arrow-circle-right"></i></a>
            </div>
        </div>

        <div class="col-lg-3 col-xs-6">
            <!-- small box -->
            <div class="small-box bg-red">
                <div class="inner">
                    <h3>{{total_messages}}</h3>

                    <p>Total Messages</p>
                </div>
                <div class="icon">
                    <i class="ion ion-pie-graph"></i>
                </div>
                <a href="/ap/customer/message/list" class="small-box-footer">More info <i
                        class="fa fa-arrow-circle-right"></i></a>
            </div>
        </div>
        <!-- ./col -->
    </div>
    <!-- /.row -->


    <div class="row">
        <div class="col-md-6">
            <!-- Bar chart for sales by month -->
            <div class="box box-primary">
                <div class="box-header with-border">
                    <i class="fa fa-bar-chart-o"></i>

                    <h3 class="box-title">Sales By Month (In USD)</h3>
                    <div style="width: 100%">
                        <h3><strong>Total Sales:</strong> <strong>{% if total_sales %} {{total_sales}} {% else %} 0.0 {% endif %} <small>USD</small></strong></h3>
                        <small><a href="/ap/product/purchase/history">See product purchase history</a></small>
                    </div>

                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse"><i
                                class="fa fa-minus"></i>
                        </button>
                        <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i>
                        </button>
                    </div>
                </div>
                <div class="box-body">
                    <div id="bar-chart" style="height: 300px;"></div>
                </div>
                <!-- /.box-body-->
            </div>
            <!-- /.box -->


            <!-- orders  -->
            <div class="box box-solid bg-teal-gradient">
                <div class="box-header">
                    <i class="fa fa-th"></i>

                    <h3 class="box-title">Orders</h3>

                    <div class="box-tools pull-right">
                        <button type="button" class="btn bg-teal btn-sm" data-widget="collapse"><i
                                class="fa fa-minus"></i>
                        </button>
                        <button type="button" class="btn bg-teal btn-sm" data-widget="remove"><i
                                class="fa fa-times"></i>
                        </button>
                    </div>
                </div>
                <div class="box-body border-radius-none text-center" style="background: #00A65A;">
                    <div>
                        <h2>Total Orders</h2>
                        <h3>{{total_orders}}</h3>
                    </div>
                </div>
                <!-- /.box-body -->
                <div class="box-footer no-border">
                    <div class="row">
                        <div class="col-xs-4 text-center" style="border-right: 1px solid #f4f4f4">
                            <input type="text" class="knob" data-readonly="true"
                                   value="{% if current_orders %} {{current_orders}} {% else %} 0 {% endif %}"
                                   data-width="80" data-height="80"
                                   data-fgColor="#222D32">

                            <div class="knob-label" style="font-size: 18px;"><strong>Current Orders</strong></div>
                        </div>
                        <!-- ./col -->
                        <div class="col-xs-4 text-center" style="border-right: 1px solid #f4f4f4">
                            <input type="text" class="knob" data-readonly="true" value="{{delivered_orders}}"
                                   data-width="80" data-height="80"
                                   data-fgColor="#39CCCC">

                            <div class="knob-label" style="font-size: 18px;"><strong>Delivered</strong></div>
                        </div>
                        <!-- ./col -->
                        <div class="col-xs-4 text-center">
                            <input type="text" class="knob" data-readonly="true" value="{{cancelled_orders}}"
                                   data-width="80" data-height="80"
                                   data-fgColor="#DD4B39">

                            <div class="knob-label" style="font-size: 18px;"><strong>Cancelled</strong></div>
                        </div>
                        <!-- ./col -->

                        <!-- ./col -->
                        <div class="col-xs-4 text-center">
                            <input type="text" class="knob" data-readonly="true" value="{{on_the_way_order_list}}"
                                   data-width="80" data-height="80"
                                   data-fgColor="#F39C12">

                            <div class="knob-label" style="font-size: 18px;"><strong>On the way</strong></div>
                        </div>
                        <!-- ./col -->
                    </div>
                    <!-- /.row -->
                </div>
                <!-- /.box-footer -->
            </div>
            <!-- /.box -->
            <!-- /.box -->

        </div>
        <!-- /.col (LEFT) -->
        <div class="col-md-6">
            <!-- LINE CHART -->
            <div class="box box-info">
                <div class="box-header with-border">
                    <h3 class="box-title">Purchase History</h3>


                </div>
                <div class="box-body purchase__history">
                    <div class="spin_credit text-center" style="margin-left: auto; margin-right: auto;">
                        <h4>Revenue From <strong>Spin Credit</strong> Purchase</h4>
                        <h5><strong>{% if revenue_from_credit_purchase.paid_amount__sum %}
                            {{revenue_from_credit_purchase.paid_amount__sum}} {% else %} 0 {% endif %}
                            <small>USD</small></strong></h5>
                        <a href="/ap/spin/credit/purchase/history">
                            <button type="button">See purchase history</button>
                        </a>
                    </div>

                    <div class="spin_token text-center" style="margin-left: auto; margin-right: auto;">
                        <h4>Revenue From <strong>Spin Token</strong> Purchase</h4>
                        <h5><strong>{% if revenue_from_spin_token_purchase.amount_paid__sum %}
                            {{revenue_from_spin_token_purchase.amount_paid__sum}} {% else %} 0 {% endif %}
                            <small>USD</small></strong></h5>
                        <a href="/ap/spin/token/purchase/history">
                            <button type="button">See purchase history</button>
                        </a>

                    </div>
                </div>
                <!-- /.box-body -->
            </div>
            <!-- /.box -->


            <div class="box box-solid bg-teal-gradient">
                <div class="box-header">
                    <i class="fa fa-th"></i>

                    <h3 class="box-title">Orders</h3>

                    <div class="box-tools pull-right">
                        <button type="button" class="btn bg-teal btn-sm" data-widget="collapse"><i
                                class="fa fa-minus"></i>
                        </button>
                        <button type="button" class="btn bg-teal btn-sm" data-widget="remove"><i
                                class="fa fa-times"></i>
                        </button>
                    </div>
                </div>
                <div class="box-body border-radius-none text-center" style="background: #00A65A;">
                    <div>
                        <h2>Total Visitors</h2>
                        <h3>{{total_no_of_visitors}}</h3>
                    </div>
                    <div>
                        <a href="/ap/unique/visitors/list/" style="color: white; text-style: underline;">View all unique visitors</a>
                    </div>
                </div>
                <!-- /.box-body -->
                 <!-- /.box-body -->
                <div class="box-footer no-border">
                    <div class="row">
                        <div class="col-xs-4 text-center" style="border-right: 1px solid #f4f4f4">
                            <div style="width: 130px; height: 130px; border: 10px solid #DD4B39; border-radius: 50%; position: relative;">
                                <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 30px; color: black;">
                                    {{total_no_of_visitors.num_of_visitor}}
                                </div>
                            </div>

                            <div class="knob-label" style="font-size: 18px;"><strong>Total Visitors</strong></div>
                        </div>
                        <!-- ./col -->
                        <div class="col-xs-4 text-center" style="border-right: 1px solid #f4f4f4">
                            <div style="width: 130px; height: 130px; border: 10px solid #39CCCC; border-radius: 50%; position: relative;">
                                <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 30px; color: black;">
                                    {{unique_visitors}}
                                </div>
                            </div>

                            <div class="knob-label" style="font-size: 18px;"><strong>Unique Visitors</strong></div>
                        </div>
                        <!-- ./col -->
                        <div class="col-xs-4 text-center">
                            <div style="width: 130px; height: 130px; border: 10px solid #F39C12; border-radius: 50%; position: relative;">
                                <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 30px; color: black;">
                                    {{total_no_of_shoppers_account}}
                                </div>
                            </div>

                            <div class="knob-label" style="font-size: 18px;"><strong>Shopper Account</strong></div>
                        </div>
                        <!-- ./col -->

                        <div class="col-xs-12">
                            <!-- USERS LIST -->
                            <br><br>
                          <div class="box box-danger">
                            <div class="box-header with-border">
                              <h3 class="box-title">Latest Members</h3>

                              <div class="box-tools pull-right">
                                <span class="label label-danger">{{latest_registered_accnts.count}} New Members</span>
                                <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
                                </button>
                                <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i>
                                </button>
                              </div>
                            </div>
                            <!-- /.box-header -->
                            <div class="box-body no-padding">
                              <ul class="users-list clearfix">
                                  {% if latest_registered_accnts_with_profile_pic %}
                                  {% for member in latest_registered_accnts_with_profile_pic %}

                                  <li>
                                      {% for pic in profile_pic_list_of_ltst_accnts %}
                                      {% if pic.user.pk == member.pk %}
                                      <img src="{{pic.pic.url}}" style="width: 60px; height: 60px;" alt="User Image">
                                      {% endif %}
                                      {% endfor %}
                                      <a class="users-list-name" href="#">{{member.fname}} {{member.lname}}</a>
                                      <span class="users-list-date">{{member.joined_at}}</span>
                                  </li>

                                  {% endfor %}
                                  {% endif %}

                                  {% if latest_registered_accnts_without_profile_pic %}
                                    {% for user in latest_registered_accnts_without_profile_pic %}
                                    <li>
                                    <img src="{% static 'backEnd/dist/img/avatar.png' %}" style="width: 60px; height: 60px;" alt="User Image">
                                      <a class="users-list-name" href="#">{{user.fname}} {{user.lname}}</a>
                                      <span class="users-list-date">{{user.joined_at}}</span>
                                        </li>
                                    {% endfor %}
                                  {% endif %}
                              </ul>
                              <!-- /.users-list -->
                </div>
                <!-- /.box-body -->
                <div class="box-footer text-center">
                  <a href="/ap/registered/user/list" class="uppercase">View All Users</a>
                </div>
                <!-- /.box-footer -->
              </div>
              <!--/.box -->
                        </div>
                    </div>
                    <!-- /.row -->
                </div>
                <!-- /.box-footer -->
            </div>
            <!-- /.box -->

        </div>
        <!-- /.col (RIGHT) -->
    </div>
</section>

{% endblock %}

{% block datatable_js %}
<!-- DataTables -->
<script src="{% static 'backEnd/bower_components/datatables.net/js/jquery.dataTables.min.js' %}"></script>
<script src="{% static 'backEnd/bower_components/datatables.net-bs/js/dataTables.bootstrap.min.js' %}"></script>

<script>
  $(function () {
    $('#example1').DataTable()
    $('#example2').DataTable({
      'paging'      : true,
      'lengthChange': false,
      'searching'   : false,
      'ordering'    : true,
      'info'        : true,
      'autoWidth'   : false
    })
  })






</script>

{% endblock %}

{% block chartJS %}

<!-- FastClick -->
<script src="{% static 'backEnd/bower_components/fastclick/lib/fastclick.js' %}"></script>
<!-- AdminLTE App -->
<script src="{% static 'backEnd/dist/js/adminlte.min.js' %}"></script>
<!-- AdminLTE for demo purposes -->
<script src="{% static 'backEnd/dist/js/demo.js' %}"></script>
<!-- page script -->
<script src="{% static 'backEnd/bower_components/chart.js/Chart.js' %}"></script>
<script src="{% static 'backEnd/chart.js' %}"></script>


<script>

  $(function () {
    /* ChartJS
     * -------
     * Here we will create a few charts using ChartJS
     */

    //--------------
    //- AREA CHART -
    //--------------

    // Get context with jQuery - using jQuery's .get() method.
    var areaChartCanvas = $('#areaChart').get(0).getContext('2d')
    // This will get the first returned node in the jQuery collection.
    var areaChart       = new Chart(areaChartCanvas)

    var areaChartData = {
      labels  : ['January', 'February', 'March', 'April', 'May', 'June', 'July'],
      datasets: [
        {
          label               : 'Electronics',
          fillColor           : 'rgba(210, 214, 222, 1)',
          strokeColor         : 'rgba(210, 214, 222, 1)',
          pointColor          : 'rgba(210, 214, 222, 1)',
          pointStrokeColor    : '#c1c7d1',
          pointHighlightFill  : '#fff',
          pointHighlightStroke: 'rgba(220,220,220,1)',
          data                : [65, 59, 80, 81, 56, 55, 40]
        },
        {
          label               : 'Digital Goods',
          fillColor           : 'rgba(60,141,188,0.9)',
          strokeColor         : 'rgba(60,141,188,0.8)',
          pointColor          : '#3b8bba',
          pointStrokeColor    : 'rgba(60,141,188,1)',
          pointHighlightFill  : '#fff',
          pointHighlightStroke: 'rgba(60,141,188,1)',
          data                : [28, 48, 40, 19, 86, 27, 90]
        }
      ]
    }

    var areaChartOptions = {
      //Boolean - If we should show the scale at all
      showScale               : true,
      //Boolean - Whether grid lines are shown across the chart
      scaleShowGridLines      : false,
      //String - Colour of the grid lines
      scaleGridLineColor      : 'rgba(0,0,0,.05)',
      //Number - Width of the grid lines
      scaleGridLineWidth      : 1,
      //Boolean - Whether to show horizontal lines (except X axis)
      scaleShowHorizontalLines: true,
      //Boolean - Whether to show vertical lines (except Y axis)
      scaleShowVerticalLines  : true,
      //Boolean - Whether the line is curved between points
      bezierCurve             : true,
      //Number - Tension of the bezier curve between points
      bezierCurveTension      : 0.3,
      //Boolean - Whether to show a dot for each point
      pointDot                : false,
      //Number - Radius of each point dot in pixels
      pointDotRadius          : 4,
      //Number - Pixel width of point dot stroke
      pointDotStrokeWidth     : 1,
      //Number - amount extra to add to the radius to cater for hit detection outside the drawn point
      pointHitDetectionRadius : 20,
      //Boolean - Whether to show a stroke for datasets
      datasetStroke           : true,
      //Number - Pixel width of dataset stroke
      datasetStrokeWidth      : 2,
      //Boolean - Whether to fill the dataset with a color
      datasetFill             : true,
      //String - A legend template
      //Boolean - whether to maintain the starting aspect ratio or not when responsive, if set to false, will take up entire container
      maintainAspectRatio     : true,
      //Boolean - whether to make the chart responsive to window resizing
      responsive              : true
    }

    //Create the line chart
    areaChart.Line(areaChartData, areaChartOptions)


  })





</script>

<script>
  $(function () {
    /*
     * BAR CHART and sales by current month
     * ---------
     */
     var crnt_january_sales = parseFloat("{{crnt_january_sales}}");
     var crnt_feb_sales = parseFloat("{{crnt_feb_sales}}");
     var crnt_march_sales = parseFloat('{{crnt_march_sales}}');
     var crnt_april_sales = parseFloat('{{crnt_april_sales}}');
     var crnt_may_sales = parseFloat('{{crnt_may_sales}}');
     var crnt_jun_sales = parseFloat('{{crnt_jun_sales}}');
     var crnt_july_sales = parseFloat('{{crnt_july_sales}}');
     var crnt_august_sales = parseFloat('{{crnt_august_sales}}');
     var crnt_septem_sales = parseFloat('{{crnt_septem_sales}}');
     var crnt_october_sales = parseFloat('{{crnt_october_sales}}');
     var crnt_novembr_sales = parseFloat('{{crnt_novembr_sales}}');
     var crnt_decmbr_sales = parseFloat('{{crnt_decmbr_sales}}');
    console.log(crnt_jun_sales);
    var bar_data = {
      data : [['Jan', crnt_january_sales ? crnt_january_sales : 0],
      ['Feb', crnt_feb_sales ? crnt_feb_sales : 0],
      ['Mar', crnt_march_sales ? crnt_march_sales : 0],
      ['Apr', crnt_april_sales ? crnt_april_sales : 0],
      ['May', crnt_may_sales ? crnt_may_sales : 0],
      ['Jun', crnt_jun_sales ? crnt_jun_sales : 0],
      ['Jul', crnt_july_sales ? crnt_july_sales : 0],
      ['Aug', crnt_august_sales ? crnt_august_sales : 0],
      ['Sept', crnt_septem_sales ? crnt_septem_sales : 0],
      ['Oct', crnt_october_sales ? crnt_october_sales : 0],
      ['Nov', crnt_novembr_sales ? crnt_novembr_sales : 0],
      ['Dec', crnt_decmbr_sales ? crnt_decmbr_sales : 0]
      ],
      color: '#3c8dbc'
    }
    $.plot('#bar-chart', [bar_data], {
      grid  : {
        borderWidth: 1,
        borderColor: '#f3f3f3',
        tickColor  : '#f3f3f3'
      },
      series: {
        bars: {
          show    : true,
          barWidth: 0.5,
          align   : 'center'
        }
      },
      xaxis : {
        mode      : 'categories',
        tickLength: 0
      }
    })
    /* END BAR CHART */

  })

  /*
   * Custom Label formatter
   * ----------------------
   */
  function labelFormatter(label, series) {
    return '<div style="font-size:13px; text-align:center; padding:2px; color: #fff; font-weight: 600;">'
      + label
      + '<br>'
      + Math.round(series.percent) + '%</div>'
  }





</script>
<!--float chart js-->
<!-- FLOT CHARTS -->
<script src="{% static 'backEnd/bower_components/Flot/jquery.flot.js' %}"></script>
<!-- FLOT RESIZE PLUGIN - allows the chart to redraw when the window is resized -->
<script src="{% static 'backEnd/bower_components/Flot/jquery.flot.resize.js' %}"></script>
<!-- FLOT PIE PLUGIN - also used to draw donut charts -->
<script src="{% static 'backEnd/bower_components/Flot/jquery.flot.pie.js' %}"></script>
<!-- FLOT CATEGORIES PLUGIN - Used to draw bar charts -->
<script src="{% static 'backEnd/bower_components/Flot/jquery.flot.categories.js' %}"></script>

{% endblock %}