{% extends 'frontEnd/index.html' %}
{% load static %}

{% block main_block %}
<!-- Begin Li's Breadcrumb Area -->
<div class="breadcrumb-area">
    <div class="container">
        <div class="breadcrumb-content">
            <ul>
                <li><a href="index.html">Home</a></li>
                <li class="active">Checkout</li>
            </ul>
        </div>
    </div>
</div>
<!-- Li's Breadcrumb Area End Here -->

<!--   django message         -->
<div class="container">
    <div class="row">
        <div class="col-md-12">
            {% if messages %}
            {% for message in messages %}

            <div {% if message.tags %} class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert"
                 {% endif %}>
                <strong>{{ message }}!</strong>
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>

            {% endfor %}
            {% endif %}
        </div>
    </div>
</div>

<!-- ads -->
<div class="container">
    <div class="row">
        <div class="col-md-6">
            {% if row_1_col_1_ads.ads_script %}
            {{row_1_col_1_ads.ads_script}}
            {% else %}
            <!--yllx 468x60 starts &*************************************-->
            <script type="text/javascript"
                    src="https://udbaa.com/bnr.php?section=General&pub=444213&format=468x60&ga=g"></script>
            <!--yllx ends here **********************************-->
            {% endif %}
        </div>
        <div class="col-md-6">
            {% if row_1_col_2_ads.ads_script %}
            {{row_1_col_2_ads.ads_script}}
            {% else %}
            <!--yllx 468x60 starts &*************************************-->
            <script type="text/javascript"
                    src="https://udbaa.com/bnr.php?section=General&pub=444213&format=468x60&ga=g"></script>
            <!--yllx ends here **********************************-->
            {% endif %}
        </div>
    </div>
</div>
<!-- ads ends here-->

<!-- payment section    -->

<section id="payment__section">
    <div class="container">
        <div class="row">
            <div class="col-md-3"></div>
            <div class="col-md-6">
                <div class="content">
                    <div>
                        <!--                        <h6 style="margin-bottom: 10px; opacity: .7">Available Credits: {{available_points}}</h6>-->
                        <!--                        <h6 style="margin-bottom: 10px; opacity: .7">Winning chance: {{winning_chance}}</h6>-->
                        <!--                        <h6 style="margin-bottom: 15px; opacity: .7">Total payable amount: ${{payable_amount}}</h6>-->
                        <table class="table">
                            <thead>
                            <div class="text-center p-4">
                                {% if site_logo %}
                                <img src="{{site_logo.logo.url}}" style="width: 120px; height: 80px;" alt=""/>
                                {% else %}
                                <h5>Logo not added</h5>
                                {% endif %}
                                <h4>Please confirm and proceed to buy <strong>Spin Token</strong></h4>
                            </div>
                            <tr>
                                <th scope="col">#1</th>
                                <th scope="col">Number of Token</th>
                                <th scope="col">Amout($)</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <th scope="row">1</th>
                                <td>{{winning_chance}}
                                </td>
                                <td>${{payable_amount}}</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                    <div id="paypal-button-container"></div>
                </div>
            </div>
            <div class="col-md-3">
            </div>
        </div>
    </div>
</section>


<br><br>


<div class="container">
    <div class="row">
        <div class="col-md-4">
            {% if row_2_col_1_ads.ads_script %}
            {{row_2_col_1_ads.ads_script}}
            {% else %}
            <script data-cfasync='false' type='text/javascript'
                    src='//p447162.clksite.com/adServe/banners?tid=447162_875550_3&size=17'></script>
            {% endif %}
        </div>

        <div class="col-md-4">
            <div>
                <h5>Click to this reCaptcha and get 50 points bonus!</h5>
                <form action="{% url 'frontPymntPgPrchasingWinningChnceCheckBoxCaptchaBonus' %}" method="POST"
                      enctype="multipart/form-data"
                      id="captcha__form_prchage_wnning_chance">
                    {% csrf_token %}
                    <div id="html_element_pr_win_chance"></div>
                    <br>
                    <button type="submit" class="captcha_submit__btn"><img
                            src="{% static 'frontEnd/images/logo/logo.jpeg' %}" alt=""> &nbsp; Click to Collect
                    </button>
                    <!--                    <input type="submit" value="Collect">-->
                </form>
            </div>
        </div>

        <div class="col-md-4">
            {% if row_2_col_2_ads.ads_script %}
            {{row_2_col_2_ads.ads_script}}
            {% else %}
            <script data-cfasync='false' type='text/javascript'
                    src='//p447162.clksite.com/adServe/banners?tid=447162_875550_0'></script>
            {% endif %}
        </div>
    </div>
</div>

<br>
<section id="captcha__section">
    <div class="container">
        <div class="row">
            <div class="col-md-4">
                <div class="row">
                    <div class="col-md-12">
                        <div>
                            {% if row_3_col_1_ads.ads_script %}
                            {{row_3_col_1_ads.ads_script}}
                            {% else %}
                            <!--                            <script data-cfasync='false' type='text/javascript' src='//p447162.clksite.com/adServe/banners?tid=447162_875550_3&size=15'></script>-->
                            <script type="text/javascript"
                                    src="https://udbaa.com/bnr.php?section=General&pub=444213&format=300x250&ga=g"></script>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-4">
                {% if row_3_col_2_ads.ads_script %}
                {{row_3_col_2_ads.ads_script}}
                {% else %}
                <script type="text/javascript"
                        src="https://udbaa.com/bnr.php?section=General&pub=444213&format=300x250&ga=g"></script>
                {% endif %}
            </div>

            <div class="col-md-4">
                {% if row_3_col_3_ads.ads_script %}
                {{row_3_col_3_ads.ads_script}}
                {% else %}
                <a href="https://yllix.com/publishers/444213" target="_blank"><img
                        src="//ylx-aff.advertica-cdn.com/pub/300x250.png"
                        style="border:none;margin:0;padding:0;vertical-align:baseline;"
                        alt="ylliX - Online Advertising Network"/></a>
                {% endif %}
            </div>

        </div>
    </div>
</section>


<!-- yllx 120x60 starts here -->
<div class="container">
    <div class="row">
        <div class="col-md-2">
            <div>
                {% if row_4_col_1_ads.ads_script %}
                {{row_4_col_1_ads.ads_script}}
                {% else %}
                <a href="https://yllix.com/publishers/444213" target="_blank"><img
                        src="//ylx-aff.advertica-cdn.com/pub/120x600.png"
                        style="border:none;margin:0;padding:0;vertical-align:baseline;"
                        alt="ylliX - Online Advertising Network"/></a>
                {% endif %}
            </div>
        </div>

        <div class="col-md-4">
            <div>
                {% if row_4_col_2_ads.ads_script %}
                {{row_4_col_2_ads.ads_script}}
                {% else %}
                <div id="container-ec5611cf27ddd923a905f8d14e217991"></div>
                {% endif %}

            </div>
        </div>

        <div class="col-md-2">
            <div>
                {% if row_4_col_3_ads.ads_script %}
                {{row_4_col_3_ads.ads_script}}
                {% else %}
                <!-- ylliex 120x60 -->
                <script type="text/javascript"
                        src="https://udbaa.com/bnr.php?section=General&pub=444213&format=120x600&ga=g"></script>
                <!-- yllix 120x60 ends here -->
                {% endif %}
            </div>
        </div>

        <div class="col-md-2">
            <div>
                {% if row_4_col_4_ads.ads_script %}
                {{row_4_col_4_ads.ads_script}}
                {% else %}
                <a href="https://yllix.com/publishers/444213" target="_blank"><img
                        src="//ylx-aff.advertica-cdn.com/pub/120x600.png"
                        style="border:none;margin:0;padding:0;vertical-align:baseline;"
                        alt="ylliX - Online Advertising Network"/></a>
                {% endif %}
            </div>
        </div>

        <div class="col-md-2">
            <div>
                {% if row_4_col_5_ads.ads_script %}
                {{row_4_col_5_ads.ads_script}}
                {% else %}
                <!-- ylliex 120x60 -->
                <script type="text/javascript"
                        src="https://udbaa.com/bnr.php?section=General&pub=444213&format=120x600&ga=g"></script>
                <!-- yllix 120x60 ends here -->
                {% endif %}
            </div>
        </div>

    </div>
</div>
<!-- yllx 120x60 ends here -->

<div class="container">
    <div class="row">
        <div class="col-md-6">
            <div>
                {% if row_5_col_1_ads.ads_script %}
                {{row_5_col_1_ads.ads_script}}
                {% else %}
                <script type="text/javascript">
                                            atOptions = {
                                                'key' : '8641aba4c7f1250ff3a115fcbcb8a5d6',
                                                'format' : 'iframe',
                                                'height' : 60,
                                                'width' : 468,
                                                'params' : {}
                                            };
                                            document.write('<scr' + 'ipt type="text/javascript" src="http' + (location.protocol === 'https:' ? 's' : '') + '://www.effectivedisplayformats.com/8641aba4c7f1250ff3a115fcbcb8a5d6/invoke.js"></scr' + 'ipt>');

                </script>
                {% endif %}
            </div>
        </div>

        <div class="col-md-6">
            <div>
                {% if row_5_col_2_ads.ads_script %}
                {{row_5_col_2_ads.ads_script}}
                {% else %}
                <script type="text/javascript">
                                            atOptions = {
                                                'key' : '8641aba4c7f1250ff3a115fcbcb8a5d6',
                                                'format' : 'iframe',
                                                'height' : 60,
                                                'width' : 468,
                                                'params' : {}
                                            };
                                            document.write('<scr' + 'ipt type="text/javascript" src="http' + (location.protocol === 'https:' ? 's' : '') + '://www.effectivedisplayformats.com/8641aba4c7f1250ff3a115fcbcb8a5d6/invoke.js"></scr' + 'ipt>');

                </script>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<!-- ads section ends -->


<script type="text/javascript">

// captcha-1
      var onloadCallback = function() {


        grecaptcha.render('html_element_pr_win_chance', {
          'sitekey' : '6LeyWrMfAAAAALCToOdJC3Y5Xat2bgwCZMJLL2E2',
        });
      };


      var captcha__form_prchage_wnning_chance = document.getElementById('captcha__form_prchage_wnning_chance');
        captcha__form_prchage_wnning_chance.addEventListener("submit", function(event){

            if (grecaptcha.getResponse() === '') {
              event.preventDefault();
              alert('Please check the recaptcha');
            }
          }
        , false);

        // ends captcha-1

</script>
{% endblock %}

{% block google_mapJS %}
<!-- Google Map -->
<script src="https://maps.google.com/maps/api/js?sensor=false&amp;libraries=geometry&amp;v=3.22&amp;key=AIzaSyChs2QWiAhnzz0a4OEhzqCXwx_qA9ST_lE"></script>
{% endblock %}

{% block payment_integration_block %}
<!--AZCZ-SPWtsvWifDAEVsJwDwndfhyNBvbzaPyRWf9-Uqfp7vN55ZN60D3szeGs32QkClayqGw65DjpFkF-->
<script src="https://www.paypal.com/sdk/js?client-id=AcAWRV3bad-SO2OtqY-HdU2lO24a23hLfwJygHg5pj0Rpj0VehocsqOF4jtdqvAAZMgK525Pe0dor0lE&currency=USD"></script>

<script>
      paypal.Buttons({
        // Sets up the transaction when a payment button is clicked
        createOrder: (data, actions) => {
          return actions.order.create({
            purchase_units: [{
              amount: {
                value: '{{payable_amount}}' // Can also reference a variable or function
              }
            }]
          });
        },
        // Finalize the transaction after payer approval
        onApprove: (data, actions) => {
          return actions.order.capture().then(function(orderData) {
            // Successful capture! For dev/demo purposes:
            //console.log('Capture result', orderData, JSON.stringify(orderData, null, 2));
            const transaction = orderData.purchase_units[0].payments.captures[0];
            //alert(`Transaction ${transaction.status}: ${transaction.id}\n\nSee console for all available details`);
            // When ready to go live, remove the alert and show a success message within this page. For example:
            //const element = document.getElementById('paypal-button-container');
            //element.innerHTML = '<h3>Thank you for your payment!</h3>';
            //actions.redirect('');

            // ajax request
            $.ajax({
                url: '/fe/pay/for/game/purchasing/chance/',
                type: 'get',
                data: {
                    paid_amount: "{{payable_amount}}",
                    purchased_chances: "{{winning_chance}}",
                    // available_points: "{{available_points}}",
                    order_data: JSON.stringify(orderData, null, 2),
                },
                success: function(response){

                },
            });
            // ajax

            // Simulate a mouse click:
            window.location.href = "/fe/purchaing/winning/chance/success/message/{{request.user.username}}";

          });
        }
      }).render('#paypal-button-container');




</script>

{% endblock %}